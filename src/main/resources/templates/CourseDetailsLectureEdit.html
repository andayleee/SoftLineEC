<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" style="background-color: #FFFFFF">
<head>
  <title>SoftLineEC - учет курсов</title><link th:href="@{/css/main.css}" rel="stylesheet" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body style="background-color: #FFFFFF">
<form th:action="${'/CreateNewCourse/details/Lecture/Edit'}" method="post" th:each="el: ${Lecture}" th:object="${Lecture}">
  <div th:insert="blocks/header.html"/>
  <div th:insert="blocks/nav.html"/>
  <div class="lecture" style="margin-top: 15vh; margin-left: 20vw; margin-right: 12vw;">
    <div class="boxes">
      <h1 class="title">Изменение лекции</h1>
    </div>
    <div class="group" >
      <input type="text" th:value="${el.nameOfLecture}" class="nameOfLecture" name="nameOfLecture" required>
      <span class="highlight"></span>
      <span class="bar"></span>
      <label>Название лекции</label>
    </div>
    <div class="group">
      <textarea class="textar" th:value="${el.description}" th:text="${el.description}" placeholder="Описание" name="description" ></textarea>
    </div>
    <div class="group">
      <input type="text" class="additionalLiterature" th:value="${el.additionalLiterature}" name="additionalLiterature" required>
      <span class="highlight"></span>
      <span class="bar"></span>
      <label>Доп литература</label>
    </div>
    <button type="submit" id="save-lecture" class="custom-btn btn-16">Изменить лекцию</button>
  </div>
</form>
<script type="text/javascript" th:src="@{/js/textAreaResize.js}" src="/js/textAreaResize.js"></script>
<script src="https://unpkg.com/imask" type="text/javascript"></script> <!-- Подключаем плагин через CDN -->
<script type="text/javascript" th:src="@{/js/jquery.maskedinput.js}" src="/js/jquery.maskedinput.js"></script>
<script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
<script>
  document.getElementById("save-lecture").addEventListener("click", function() {
    var nameOfLectureValues = [];
    var descriptionValues = [];
    var additionalLiteratureValues = [];
    $('.lecture').each(function() {
      var value = $(this).find('.nameOfLecture').val();
      nameOfLectureValues.push(value);
      var value1 = $(this).find('textarea').val();
      descriptionValues.push(value1);
      var value2 = $(this).find('.additionalLiterature').val();
      additionalLiteratureValues.push(value2);
    });
    console.log(nameOfLectureValues);
    console.log(descriptionValues);
    console.log(additionalLiteratureValues);
    var data = {
      nameOfLecture: nameOfLectureValues,
      description: descriptionValues,
      additionalLiterature: additionalLiteratureValues
    };
    console.log(JSON.stringify(data));
    if (nameOfLectureValues.includes(null) || nameOfLectureValues.includes("") || descriptionValues.includes(null) || descriptionValues.includes("")||additionalLiteratureValues.includes(null) || additionalLiteratureValues.includes("")) {
      alert("Введите все данные");
    } else {
      $.ajax({
        url: '/handleLectureEdit',
        type: 'POST',
        data: JSON.stringify(data),
        contentType: "application/json;charset=UTF-8",
        success: function (data) {
          console.log("sucsess");
          window.location.href = "/CreateNewCourse/details";
        },
        error: function (jqXHR, textStatus, errorThrown) {
          console.error(textStatus, errorThrown);
          alert("Данные невалидны!");
        }
      });
    }
  });
</script>
</body>
</html>